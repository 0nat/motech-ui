<motech-list controller="MessagesController" paginated>
    <motech-list-header>
        <div class="btn-group pull-right">
            <button class="icon-refresh" ng-click="refresh()">{{'admin.refresh' | translate}}</button>
        </div>
        <div class="button-group">
            <button class="icon-filter motech-sidebar-button" type="button">{{'admin.messages.filters' | translate}}</button>
        </div>
    </motech-list-header>
    <motech-list-body>
        <div class="alert alert-info" ng-show="messages.length < 1">
            <span><p>{{'admin.messages.empty' | translate}}</p></span>
        </div>
    </motech-list-body>
    <motech-list-item ng-repeat="message in pagedItems[currentPage]">
        <fieldset class="form-inline">
            <div class="form-group">
                <ul class="message-list">
                    <li>
                        <span>{{printDate(message.date) | date:'yyyy-MM-dd HH:mm:ss'}}</span>&nbsp;
                        <a ng-href="?moduleName={{message.moduleName}}"><span class="msg-level">[{{message.moduleName}}]</span></a>
                    </li>
                    <li><span class="msg-level badge" ng-class="getCssClass(message)">{{message.level}}</span>&nbsp;<span> {{printText(message.text)}}</span></li>
                </ul>
            </div>
            <div class="form-group">
                <a ng-click="remove(message)" class="margin-before05 btn btn-danger btn-sm pull-right"><i class="fa fa-trash-o"></i></a>
            </div>
        </fieldset>
    </motech-list-item>
    <motech-list-footer>
        <uib-pagination total-items="messages" ng-model="currentPage" ng-change="changePageTo(currentPage)"></uib-pagination>
    </motech-list-footer>
</motech-list>
<motech-sidebar title="{{'admin.messages.filters' | translate }}">
    <form>
        <fieldset>
            <legend>{{'admin.messages.search' | translate}}</legend>
            <div class="form-group">
                <input type="text" ng-model="filterSearch.query" ng-change="search()" class="form-control input-sm search-query" placeholder="{{msg('admin.messages.searchByContent')}}">
            </div>
        </fieldset>
        <fieldset>
            <legend>{{'admin.messages.date' | translate}}</legend>
            <div class="form-group">
                <input id="messagesDateTimeFrom" messages-date-picker="" ng-model="dateTimeFrom" max="dateTimeTo" type="datetime" placeholder="{{msg('admin.messages.from')}}" data-event-type="change"
                       data-search-field="timeFrom">
            </div>
            <div class="form-group">
                <input id="messagesDateTimeTo" messages-date-picker="" ng-model="dateTimeTo" min="dateTimeFrom" type="datetime" placeholder="{{msg('admin.messages.to')}}" data-event-type="change"
                       data-search-field="timeTo">
            </div>
        </fieldset>
        <fieldset>
            <legend>{{'admin.messages.moduleName' | translate}}</legend>
            <div class="form-group input-auto">
                <select ng-model="filterModule" ng-change="setFilterModule(filterModule)">
                    <option ng-if="!filterModule" value="">
                        {{'admin.messages.select' | translate  | uppercase}}
                    </option>
                    <option ng-repeat="filterModule in modules" value="{{filterModule}}">
                        {{filterModule | uppercase}}
                    </option>
                </select>
            </div>
        </fieldset>
        <fieldset>
            <legend>{{'admin.messages.level' | translate}}</legend>
            <div class="input-group" ng-repeat="msgLevel in messagesLevels">
                <label class="checkbox">
                    <input type="checkbox" ng-model="filterLevel" ng-click="setFilterLevel(msgLevel)" set-level-filter="msgLevel" data-search-field="msgLevel" />&nbsp;{{msg('admin.messages.' + msgLevel) | uppercase}}
                </label>
            </div>
        </fieldset>
    </form>
</motech-sidebar>